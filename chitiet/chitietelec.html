<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Chi tiáº¿t sáº£n pháº©m</title>
   <link rel="stylesheet" href="../css/footer.css">
<link rel="stylesheet" href="../css/chitietsanpham.css">
</head>
<body>

<a href="../index.html" class="back-home">â† Quay vá» trang chá»§</a>

<div class="product-detail">

  <!-- áº¢NH Sáº¢N PHáº¨M -->
  <div class="product-images">
    <img src="../IMAGES/guitar/electric/custom/custom_avt.jpg" alt="Acoustic" class="main-img">
  </div>

  <!-- THÃ”NG TIN Sáº¢N PHáº¨M -->
  <div class="product-info">
    <h1 class="product-title">
      Guitar Custom Electric
    </h1>

    <div class="price-box">
      <span class="old-price">50.000.000Ä‘</span>
      <span class="new-price">10.000.000Ä‘</span>
      <span class="discount">-80%</span>
    </div>

    <p class="description">
       Trang bá»‹ pickup máº¡nh máº½, Ã¢m sáº¯c dÃ y vÃ  lá»±c, cá»±c ká»³ phÃ¹ há»£p cho ngÆ°á»i chÆ¡i solo, lead hoáº·c cÃ¡c thá»ƒ loáº¡i nháº¡c sÃ´i Ä‘á»™ng.
    </p>

    <!-- VOUCHER -->
    <div class="voucher-box">
      <div class="voucher">Giáº£m 20K</div>
      <div class="voucher">Giáº£m 25K</div>
      <div class="voucher">Giáº£m 30K</div>
    </div>

    <!-- Sá» LÆ¯á»¢NG -->
    <div class="quantity">
      <span>Sá»‘ lÆ°á»£ng:</span>
      <button onclick="giam()">âˆ’</button>
      <input type="text" id="qty" value="1">
      <button onclick="tang()">+</button>
    </div>

 <!-- NÃšT -->
    <div class="action-buttons">

      <!-- THÃŠM GIá» -->
      <button
        onclick="addToCart(this)"
        data-id="sp9"
        data-name="Guitar Custom Electric"
        data-price="10000000"
        data-image="../IMAGES/guitar/electric/custom/custom_avt.jpg">
        ThÃªm vÃ o giá»
      </button>

      <!-- MUA NGAY -->
      <button
        class="buy-now"
        onclick="buyNow(this)"
        data-id="sp9"
        data-name="Guitar Custom Electric"
        data-price="10000000"
        data-image="../IMAGES/guitar/electric/custom/custom_avt.jpg">
        Mua ngay
      </button>

    </div>

  </div>
</div>
<div class="review-section">
  <h3>ÄÃ¡nh giÃ¡ sáº£n pháº©m</h3>

  <!-- Äiá»ƒm trung bÃ¬nh -->
  <div class="review-summary">
    <span id="avgRating">5.0</span> â˜…
    <span id="totalReviews">(0 Ä‘Ã¡nh giÃ¡)</span>
  </div>

  <!-- Danh sÃ¡ch Ä‘Ã¡nh giÃ¡ -->
  <div id="reviewList"></div>

  <!-- Form ngÆ°á»i dÃ¹ng Ä‘Ã¡nh giÃ¡ -->
  <div class="review-form">
    <h4>Viáº¿t Ä‘Ã¡nh giÃ¡ cá»§a báº¡n</h4>
    <input type="text" id="reviewName" placeholder="TÃªn cá»§a báº¡n">
    
    <select id="reviewRating">
      <option value="5">5 â˜…</option>
      <option value="4">4 â˜…</option>
      <option value="3">3 â˜…</option>
      <option value="2">2 â˜…</option>
      <option value="1">1 â˜…</option>
    </select>

    <textarea id="reviewComment" placeholder="Cáº£m nháº­n cá»§a báº¡n vá» sáº£n pháº©m"></textarea>
    <button onclick="addReview()">Gá»­i Ä‘Ã¡nh giÃ¡</button>
  </div>
</div>

<div id="footer"></div>
<script>
fetch("../footer.html")
  .then(res => res.text())
  .then(html => {
    document.getElementById("footer").innerHTML = html;
  });
</script>
<script>
function addToCart(btn){
  const qty = Number(document.getElementById("qty").value);

  const product = {
    id: btn.dataset.id,
    name: btn.dataset.name,
    price: Number(btn.dataset.price),
    oldPrice: Number(btn.dataset.oldprice),
    image: btn.dataset.image,
    quantity: qty
  };

  let cart = JSON.parse(localStorage.getItem("cart")) || [];

  const exist = cart.find(p => p.id === product.id);
  if(exist){
    exist.quantity += qty;
  }else{
    cart.push(product);
  }

  localStorage.setItem("cart", JSON.stringify(cart));
  window.location.href = "../cart.html";
}

function buyNow(button) {
  let qty = parseInt(document.getElementById("qty").value) || 1;

  let product = {
    id: button.dataset.id,
    name: button.dataset.name,
    price: Number(button.dataset.price),
    oldPrice: button.dataset.oldprice ? Number(button.dataset.oldprice) : null,
    image: button.dataset.image,
    quantity: qty
  };

  localStorage.setItem("checkoutType", "buyNow");   // ğŸ”¥ ÄÃNH Dáº¤U ÄI Tá»ª MUA NGAY
  localStorage.setItem("buyNow", JSON.stringify(product));
  window.location.href = "../thanhtoan.html";
}

function tang(){
  const qtyInput = document.getElementById("qty");
  qtyInput.value = parseInt(qtyInput.value || 1) + 1;
}

function giam(){
  const qtyInput = document.getElementById("qty");
  let val = parseInt(qtyInput.value || 1);
  if(val > 1) qtyInput.value = val - 1;
}
</script>
<script>
const reviewKey = "elec_reviews"; // má»—i trang sáº£n pháº©m cÃ³ thá»ƒ Ä‘á»•i key khÃ¡c nhau

// ÄÃ¡nh giÃ¡ giáº£ ban Ä‘áº§u
const defaultReviews = [
  { user: "Minh Anh", rating: 5, comment: "ÄÃ n Ä‘áº¹p hÆ¡n hÃ¬nh, Ã¢m thanh ráº¥t áº¥m", date: "2 ngÃ y trÆ°á»›c" },
  { user: "HoÃ ng PhÃºc", rating: 4, comment: "Giao nhanh, má»›i táº­p chÆ¡i tháº¥y á»•n", date: "5 ngÃ y trÆ°á»›c" },
  { user: "Lan Chi", rating: 5, comment: "Mua táº·ng ngÆ°á»i yÃªu, áº£nh thÃ­ch láº¯m ğŸ¥°", date: "1 tuáº§n trÆ°á»›c" }
];

// Láº¥y dá»¯ liá»‡u tá»« localStorage hoáº·c dÃ¹ng fake ban Ä‘áº§u
let reviews = JSON.parse(localStorage.getItem(reviewKey)) || defaultReviews;

const reviewList = document.getElementById("reviewList");

function saveReviews() {
  localStorage.setItem(reviewKey, JSON.stringify(reviews));
}

function renderReviews(){
  reviewList.innerHTML = "";
  let total = 0;

  reviews.forEach(r => {
    total += r.rating;
    let stars = "â˜…".repeat(r.rating) + "â˜†".repeat(5 - r.rating);

    reviewList.innerHTML += `
      <div class="review-item">
        <div class="review-user">${r.user} <span style="color:#888;font-size:12px">â€¢ ${r.date}</span></div>
        <div class="review-stars">${stars}</div>
        <div class="review-text">${r.comment}</div>
      </div>
    `;
  });

  let avg = (total / reviews.length).toFixed(1);
  document.getElementById("avgRating").innerText = avg;
  document.getElementById("totalReviews").innerText = `(${reviews.length} Ä‘Ã¡nh giÃ¡)`;
}

function addReview(){
  let name = document.getElementById("reviewName").value.trim();
  let rating = parseInt(document.getElementById("reviewRating").value);
  let comment = document.getElementById("reviewComment").value.trim();

  if(name === "" || comment === ""){
    alert("Vui lÃ²ng nháº­p tÃªn vÃ  ná»™i dung Ä‘Ã¡nh giÃ¡");
    return;
  }

  let newReview = {
    user: name,
    rating: rating,
    comment: comment,
    date: "Vá»«a xong"
  };

  reviews.unshift(newReview); // thÃªm lÃªn Ä‘áº§u
  saveReviews();              // ğŸ”¥ lÆ°u láº¡i
  renderReviews();

  document.getElementById("reviewName").value = "";
  document.getElementById("reviewComment").value = "";
}

// Gá»i khi load trang
renderReviews();
</script>


</body>
</html>